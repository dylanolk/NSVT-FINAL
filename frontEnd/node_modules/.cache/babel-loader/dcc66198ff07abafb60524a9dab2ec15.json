{"ast":null,"code":"var _jsxFileName = \"/Users/kevin/Desktop/Nyquist_Shannon_MVP/frontEnd/src/components/canvas/Canvas.js\";\nimport React, { useRef, useEffect } from \"react\";\nimport { convertToObject } from \"typescript\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Canvas extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ARR_NUM: 1,\n      MOUSE_POS: 0,\n      SCALE_FACTOR: 1,\n      DISPLAY_TRANSFORM: 3,\n      DISPLAY_ORIGINAL: 1,\n      checked1: true,\n      checked2: true,\n      SHIFT: 0\n    };\n    this.getMax = this.getMax.bind(this);\n    this.display = this.display.bind(this);\n    this.wheelZoom = this.wheelZoom.bind(this);\n    this.mouseMove = this.mouseMove.bind(this);\n    this.displayTransform = this.displayTransform.bind(this);\n    this.displayOriginal = this.displayOriginal.bind(this);\n  } //Takes in current position in array, array number, and data. Returns local max and mins within a window of size SCALE_FACTOR\n\n\n  getMax(x, arraynum, data) {\n    var max = [x, 0, 0];\n\n    for (var i = 0; i < this.state.SCALE_FACTOR; i++) {\n      max[0] = x;\n      if (data[arraynum][this.state.ARR_NUM][x] > max[1]) max[1] = data[arraynum][this.state.ARR_NUM][x];else if (data[arraynum][this.state.ARR_NUM][x] < max[2]) max[2] = data[arraynum][this.state.ARR_NUM][x];\n      x++;\n    }\n\n    return max;\n  } //Main display function, called on every zoom/ update. Should not be called when there is no data. \n\n\n  display() {\n    var canvas = this.refs.canvas;\n    var c = canvas.getContext('2d');\n    var data = this.props.data;\n    var SCALE_FACTOR = this.state.SCALE_FACTOR;\n    c.canvas.width = 1920;\n    c.moveTo(0, 250);\n    c.lineTo(1920, 250);\n    c.stroke();\n\n    for (var i = this.state.DISPLAY_ORIGINAL; i < this.state.DISPLAY_TRANSFORM; i++) {\n      var change = 1;\n      if (i == 2) change = this.props.data[3]; // console.log(change);\n\n      var x_coordinate = 0;\n      c.beginPath();\n      var lines = 0;\n      var max = 0;\n\n      for (var x = Math.floor(this.state.SHIFT / Math.pow(10, this.state.ARR_NUM) / change); x < data[i][this.state.ARR_NUM].length; x++) {\n        if (lines >= 1920) break;\n\n        if (SCALE_FACTOR > 1) {\n          var y = this.getMax(x, i, data);\n          c.moveTo(Math.floor(x_coordinate * change), (0 - y[2]) / data[0][0] + 250);\n          c.lineTo(Math.floor(x_coordinate * change), (0 - y[1]) / data[0][0] + 250);\n        } else if (SCALE_FACTOR < 0) {\n          c.moveTo(x_coordinate * Math.abs(SCALE_FACTOR) * change, 250);\n          c.lineTo(x_coordinate * Math.abs(SCALE_FACTOR) * change, 0 - data[i][this.state.ARR_NUM][x] / data[0][0][0] + 250);\n          var y = [x, 0, 0];\n        } else {\n          c.moveTo(x_coordinate * change, 250);\n          c.lineTo(x_coordinate * change, 0 - data[i][this.state.ARR_NUM][x] / data[0][0][0] + 250);\n          var y = [x, 0, 0];\n        }\n\n        lines++;\n        x_coordinate += 1;\n        x = y[0];\n        max = x;\n      } // console.log(max,\"***\");\n\n\n      var colors = ['red', 'green', 'blue'];\n      c.strokeStyle = colors[i];\n      c.stroke();\n      c.closePath();\n    } // console.log(max);\n    // console.log(lines);\n\n  }\n\n  wheelZoom(event) {\n    event.preventDefault();\n\n    if (event.ctrlKey) {\n      this.state.SCALE_FACTOR = this.state.SCALE_FACTOR += Math.floor(event.deltaY / 102);\n\n      if (this.state.SCALE_FACTOR > 19 && this.state.ARR_NUM < this.props.data.length) {\n        this.state.SCALE_FACTOR = 2;\n        this.state.ARR_NUM++;\n      } else if (this.state.SCALE_FACTOR <= 1 && this.state.ARR_NUM >= 1) {\n        this.state.SCALE_FACTOR = 19;\n        this.state.ARR_NUM--;\n      }\n\n      console.log(this.state.SCALE_FACTOR, this.state.ARR_NUM);\n    } else {\n      this.state.SHIFT += Math.floor(event.deltaY / 102) * 500;\n    }\n\n    this.display();\n  } //Stores current mouse position, useful for centering zoom on mouse, not yet implemented. \n\n\n  mouseMove(event) {\n    var canvas = this.refs.canvas;\n    var cRect = canvas.getBoundingClientRect();\n    this.state.MOUSE_POS = Math.round(event.clientX - cRect.left);\n  }\n\n  componentDidMount() {\n    const canvas = this.refs.canvas;\n    const c = canvas.getContext(\"2d\");\n    c.clearRect(0, 0, canvas.width, canvas.height);\n    canvas.addEventListener(\"wheel\", this.wheelZoom);\n    canvas.addEventListener(\"mousemove\", this.mouseMove); // this.display();\n\n    c.moveTo(0, 250);\n    c.lineTo(1920, 250);\n    c.stroke();\n  }\n\n  componentDidUpdate() {\n    console.log(\"update\");\n    const canvas = this.refs.canvas;\n    const c = canvas.getContext(\"2d\");\n    c.clearRect(0, 0, canvas.width, canvas.height);\n    if (this.props.data.length > 0) this.display();\n  }\n\n  displayTransform(event) {\n    if (event.target.checked) {\n      this.setState({\n        DISPLAY_TRANSFORM: 3\n      });\n    } else this.setState({\n      DISPLAY_TRANSFORM: 2\n    });\n\n    this.display();\n    this.setState({\n      checked1: event.target.checked\n    });\n  }\n\n  displayOriginal(event) {\n    if (event.target.checked) this.setState({\n      DISPLAY_ORIGINAL: 1\n    });else this.setState({\n      DISPLAY_ORIGINAL: 2\n    });\n    this.display();\n    this.setState({\n      checked2: event.target.checked\n    });\n  }\n\n  render() {\n    console.log(\"rendered\");\n    const styles = {\n      border: \"1px solid black\"\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: \"canvas\",\n        width: 1920,\n        height: 500,\n        style: styles\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 3\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"checkbox\",\n          checked: this.state.checked1,\n          onChange: this.displayTransform\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }, this), \"Display Downsampled Waveform\", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"checkbox\",\n          checked: this.state.checked2,\n          onChange: this.displayOriginal\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 5\n        }, this), \"Display Original Waveform\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 3\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 3\n    }, this);\n  }\n\n}\n\n;\nexport default Canvas;","map":{"version":3,"sources":["/Users/kevin/Desktop/Nyquist_Shannon_MVP/frontEnd/src/components/canvas/Canvas.js"],"names":["React","useRef","useEffect","convertToObject","Canvas","Component","constructor","props","state","ARR_NUM","MOUSE_POS","SCALE_FACTOR","DISPLAY_TRANSFORM","DISPLAY_ORIGINAL","checked1","checked2","SHIFT","getMax","bind","display","wheelZoom","mouseMove","displayTransform","displayOriginal","x","arraynum","data","max","i","canvas","refs","c","getContext","width","moveTo","lineTo","stroke","change","x_coordinate","beginPath","lines","Math","floor","pow","length","y","abs","colors","strokeStyle","closePath","event","preventDefault","ctrlKey","deltaY","console","log","cRect","getBoundingClientRect","round","clientX","left","componentDidMount","clearRect","height","addEventListener","componentDidUpdate","target","checked","setState","render","styles","border","handleSubmit"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect } from \"react\";\r\nimport { convertToObject } from \"typescript\";\r\n\r\nclass Canvas extends React.Component {\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.state={\r\n\t\t\tARR_NUM : 1, \r\n\t\t\tMOUSE_POS: 0,\r\n\t\t\tSCALE_FACTOR: 1,\r\n\t\t\tDISPLAY_TRANSFORM: 3, \r\n\t\t\tDISPLAY_ORIGINAL: 1,\r\n\t\t\tchecked1:true,\r\n\t\t\tchecked2:true,\r\n\t\t\tSHIFT: 0,\r\n\t\t\t\r\n\t\t};\r\n\t\tthis.getMax=this.getMax.bind(this);\r\n\t\tthis.display=this.display.bind(this);\r\n\t\tthis.wheelZoom=this.wheelZoom.bind(this);\r\n\t\tthis.mouseMove=this.mouseMove.bind(this);\r\n\t\tthis.displayTransform= this.displayTransform.bind(this);\r\n\t\tthis.displayOriginal = this.displayOriginal.bind(this);\r\n\t}\r\n\r\n//Takes in current position in array, array number, and data. Returns local max and mins within a window of size SCALE_FACTOR\r\n\tgetMax(x,arraynum,data){\r\n\r\n\t\tvar max=[x,0,0] \r\n\t\tfor(var i=0; i<(this.state.SCALE_FACTOR); i++){\r\n\t\t\tmax[0]=x\r\n\t\t\tif(data[arraynum][this.state.ARR_NUM][x]>max[1])\r\n\t\t\t\tmax[1]=data[arraynum][this.state.ARR_NUM][x]\r\n\r\n\t\t\telse if(data[arraynum][this.state.ARR_NUM][x]<max[2])\r\n\t\t\t\tmax[2]=data[arraynum][this.state.ARR_NUM][x]\r\n\t\t\tx++\r\n\t\t}\r\n\t\treturn max\r\n\t}\r\n\r\n//Main display function, called on every zoom/ update. Should not be called when there is no data. \r\n\tdisplay(){\r\n\t\tvar canvas=this.refs.canvas;\r\n\t\tvar c=canvas.getContext('2d');\r\n\t\tvar data=this.props.data;\r\n\t\t\r\n\t\tvar SCALE_FACTOR= this.state.SCALE_FACTOR\r\n\t\t\r\n\t\tc.canvas.width=1920\r\n\t\tc.moveTo(0, 250)\r\n\t\tc.lineTo(1920, 250)\r\n\t\tc.stroke();\r\n\t\t\r\n\t\tfor(var i = this.state.DISPLAY_ORIGINAL; i<this.state.DISPLAY_TRANSFORM; i++){\r\n\t\t\tvar change=1;\r\n\t\t\tif (i==2)\r\n\t\t\t\tchange= this.props.data[3]\r\n\t\t\t// console.log(change);\r\n\t\t\tvar x_coordinate=0;\r\n\t\t\tc.beginPath();\r\n\t\t\tvar lines=0;\r\n\t\t\tvar max=0;\r\n\t\t\t\r\n\t\t\tfor(var x = Math.floor(this.state.SHIFT/Math.pow(10,this.state.ARR_NUM)/change); x<data[i][this.state.ARR_NUM].length; x++){\r\n\t\t\t\t\r\n\t\t\t\tif(lines>=1920) break;\r\n\r\n\t\t\t\tif(SCALE_FACTOR>1){\r\n\t\t\t\t\tvar y = this.getMax(x,i,data)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tc.moveTo(Math.floor(x_coordinate*change),(0-y[2])/data[0][0]+250) \r\n\t\t\t\t\t\t\tc.lineTo(Math.floor(x_coordinate*change), (0-y[1])/data[0][0]+250)\r\n\t\t\t\t}\r\n\t\t\t\telse if (SCALE_FACTOR<0) {\r\n\t\t\t\t\tc.moveTo(x_coordinate*Math.abs(SCALE_FACTOR)*change, 250) \r\n\t\t\t\t\tc.lineTo(x_coordinate*Math.abs(SCALE_FACTOR)*change, (0-data[i][this.state.ARR_NUM][x]/data[0][0][0])+250)\r\n\t\t\t\t\tvar y=[x,0,0]\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tc.moveTo(x_coordinate*change, 250) \r\n\t\t\t\t\tc.lineTo(x_coordinate*change, (0-data[i][this.state.ARR_NUM][x]/data[0][0][0])+250)\r\n\t\t\t\t\tvar y=[x,0,0]\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlines++;\r\n\t\t\t\t\r\n\t\t\t\tx_coordinate+=1;\r\n\t\t\t\tx=y[0]\r\n\t\t\t\tmax=x;\r\n\t\t\t}\r\n\t\t\t// console.log(max,\"***\");\r\n\t\t\tvar colors = ['red', 'green', 'blue']\r\n\t\t\tc.strokeStyle=colors[i];\r\n\t\t\tc.stroke();\r\n\t\t\tc.closePath();\r\n\t\t}\r\n\t\t// console.log(max);\r\n\t\t// console.log(lines);\r\n\t\t\t\r\n\t}\r\n\t\r\n\twheelZoom(event){\r\n\t\tevent.preventDefault();\r\n\t\t\r\n\t\tif(event.ctrlKey){\r\n\t\t\tthis.state.SCALE_FACTOR= this.state.SCALE_FACTOR+=Math.floor(event.deltaY/102);\r\n\t\t\tif(this.state.SCALE_FACTOR > 19 && this.state.ARR_NUM<this.props.data.length){\r\n\t\t\t\tthis.state.SCALE_FACTOR=2;\r\n\t\t\t\tthis.state.ARR_NUM++;\r\n\t\t\t}\r\n\t\t\telse if(this.state.SCALE_FACTOR <= 1 && this.state.ARR_NUM>=1){\r\n\t\t\t\tthis.state.SCALE_FACTOR=19;\r\n\t\t\t\tthis.state.ARR_NUM--;\r\n\t\t\t}\r\n\t\t\tconsole.log(this.state.SCALE_FACTOR, this.state.ARR_NUM);\r\n\t\t}\r\n\t\t\r\n\t\telse{\r\n\t\t\tthis.state.SHIFT+=Math.floor(event.deltaY/102)*500;\r\n\t\t}\r\n\t\t\r\n\t\tthis.display();\r\n\t}\r\n\t\r\n\t//Stores current mouse position, useful for centering zoom on mouse, not yet implemented. \r\n\tmouseMove(event){\r\n\t\tvar canvas=this.refs.canvas;\r\n\t\tvar cRect = canvas.getBoundingClientRect();\r\n\t\tthis.state.MOUSE_POS = Math.round(event.clientX - cRect.left);\r\n\t}\r\n\t\r\n\tcomponentDidMount(){\r\n\t\tconst canvas= this.refs.canvas;\r\n\t\tconst c= canvas.getContext(\"2d\")\r\n\t\tc.clearRect(0, 0, canvas.width, canvas.height);\r\n\t\tcanvas.addEventListener(\"wheel\", this.wheelZoom);\r\n\t\tcanvas.addEventListener(\"mousemove\", this.mouseMove);\r\n\t\t// this.display();\r\n\t\t\r\n\t\tc.moveTo(0, 250)\r\n\t\tc.lineTo(1920, 250)\r\n\t\tc.stroke()\r\n\t\t\r\n\t}\r\n\t\r\n   componentDidUpdate() {\r\n\t   console.log(\"update\");\r\n\t   const canvas= this.refs.canvas;\r\n\t\tconst c= canvas.getContext(\"2d\")\r\n\t\tc.clearRect(0, 0, canvas.width, canvas.height);\r\n\t\tif(this.props.data.length > 0)\r\n\t\t\tthis.display();\r\n\t\t\r\n\t}\r\n\t\r\n\tdisplayTransform(event){\r\n\t\tif(event.target.checked){\r\n\t\t\tthis.setState({DISPLAY_TRANSFORM: 3})\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis.setState({DISPLAY_TRANSFORM: 2})\r\n\t\tthis.display();\r\n\t\tthis.setState({checked1: event.target.checked})\r\n\t}\r\n\t\r\n\tdisplayOriginal(event){\r\n\t\tif(event.target.checked)\r\n\t\t\tthis.setState({DISPLAY_ORIGINAL: 1})\r\n\t\telse\r\n\t\t\tthis.setState({DISPLAY_ORIGINAL: 2})\r\n\t\tthis.display();\r\n\t\tthis.setState({checked2: event.target.checked})\r\n\t}\r\n\t\r\n  render(){\r\n\t  console.log(\"rendered\");\r\n\tconst styles={\r\n\t\tborder: \"1px solid black\"\r\n\t\t\r\n\t};\r\n\treturn (\r\n\t <div>\r\n\t\t<canvas ref=\"canvas\" width={1920} height={500} style={styles}/>\r\n\t\t<form onSubmit={this.handleSubmit}> \r\n          <input type=\"checkbox\" checked={this.state.checked1} onChange={this.displayTransform}/>\r\n\t\t\t{\"Display Downsampled Waveform\"}\r\n\t\t\t <input type=\"checkbox\" checked={this.state.checked2} onChange={this.displayOriginal}/>\r\n\t\t\t{\"Display Original Waveform\"}\r\n\t\t</form>\r\n\t</div>\r\n\r\n\t);\r\n  }\r\n};\r\n\r\nexport default Canvas;\r\n"]},"metadata":{},"sourceType":"module"}